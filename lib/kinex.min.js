class t{static active_animations=new Map;static to(e,s,i,r={}){return t.#e(e,s,i,r).#t()}static from(e,s,i,r={}){const n=Object.fromEntries(Object.entries(i).map((([t,e])=>[t,e])));const a=Object.fromEntries(Object.entries(i).map((([t,s])=>[t,e[t]||0])));return t.#e(e,s,a,{...r,startProperties:n}).#t()}static stop_all(){for(const e of t.active_animations.values()){e.stop()}t.active_animations.clear()}constructor(t,e,s,i={}){this.target=t;this.#s(e,s,i);this.stop=this.stop.bind(this)}stop(){this.stopped=true;if(this.animationFrame){cancelAnimationFrame(this.animationFrame)}t.active_animations.delete(this.target);if(this.resolve){this.resolve()}return this}#s(t,e,s){this.duration=t;this.delay=s.delay||0;this.startProperties=s.startProperties||{};this.properties=this.#i(e);this.easing=this.#r(s.easing);this.on_start=s.on_start||(()=>{});this.on_update=s.on_update||(()=>{});this.on_complete=s.on_complete||(()=>{});this.startTime=null;this.animationFrame=null;this.stopped=false}static#e(e,s,i,r){let n=t.active_animations.get(e);if(n){n.stop();n.#s(s,i,r)}else{n=new t(e,s,i,r);t.active_animations.set(e,n)}return n}#r(e){if(Array.isArray(e)&&e.length===4){return t.cubic_bezier(...e)}return e||(t=>t)}#i(t){return Object.entries(t).map((([t,e])=>{const s=this.startProperties[t]??this.#n(t,e);const i=this.#a(s);const r=this.#a(e);return{name:t,start:i,end:r,unit:this.#o(e),needsInterpolation:i!==r}})).filter((t=>t.needsInterpolation))}#n(t,e){if(this.reversed)return e;if(this.target instanceof Element||this.target instanceof HTMLElement){const e=this.target.style[t];if(e===""){throw new Error(`Starting value for property "${t}" is not set.`)}return e}if(!(t in this.target)){throw new Error(`Property "${t}" does not exist on the target object.`)}return this.target[t]}#a(t){if(typeof t==="number")return t;const e=parseFloat(t);return isNaN(e)?0:e}#o(t){if(typeof t==="number")return"";return String(t).replace(/^-?\d*\.?\d+/,"")||""}#t(){const t=new Promise((t=>{this.resolve=t;const e=()=>{this.startTime=performance.now();this.#h(this.startTime)};const s={};for(const t of this.properties){if(t.needsInterpolation){s[t.name]=t.unit?`${t.start}${t.unit}`:t.start}}this.on_start(s,this);if(this.delay>0){setTimeout(e,this.delay)}else{e()}}));return Object.assign(t,{stop:this.stop})}#h(e){if(this.stopped)return;if(!this.startTime)this.startTime=e;const s=e-this.startTime;let i=Math.min(s/this.duration,1);i=this.easing(i);const r={};for(const t of this.properties){const e=t.start+(t.end-t.start)*i;const s=t.unit?`${e}${t.unit}`:e;r[t.name]=s;if(this.target instanceof Element||this.target instanceof HTMLElement){this.target.style[t.name]=s}else if(this.target===window&&t.name==="scrollY"){window.scrollTo(0,e)}else{this.target[t.name]=s}}this.on_update(r,this);if(i<1){this.animationFrame=requestAnimationFrame(this.#h.bind(this))}else{if(!this.stopped){this.on_complete(r,this);t.active_animations.delete(this.target);this.resolve()}}}static cubic_bezier(t,e,s,i){const r=3*t;const n=3*(s-t)-r;const a=1-r-n;const o=3*e;const h=3*(i-e)-o;const c=1-o-h;function u(t){return((a*t+n)*t+r)*t}function l(t){return((c*t+h)*t+o)*t}function p(t){return(3*a*t+2*n)*t+r}function m(t,e=1e-6){let s,i,r,n,a;r=t;for(let s=0;s<8;s++){n=u(r)-t;if(Math.abs(n)<e)return r;a=p(r);if(Math.abs(a)<e)break;r=r-n/a}s=0;i=1;r=t;if(r<s)return s;if(r>i)return i;while(s<i){n=u(r);if(Math.abs(n-t)<e)return r;if(t>n)s=r;else i=r;r=(i-s)*.5+s}return r}return function(t){return l(m(t))}}}window.kinex=t;